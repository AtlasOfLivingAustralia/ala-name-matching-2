package au.org.ala.bayesian.generated;

import au.org.ala.bayesian.Classifier;
import au.org.ala.bayesian.InferenceException;
import au.org.ala.bayesian.ParameterAnalyser;
import au.org.ala.bayesian.StoreException;
import au.org.ala.names.builder.Builder;

import java.util.Arrays;
import java.util.Deque;
import java.util.Optional;

import au.org.ala.util.TaxonNameSoundEx;

public class Network1Builder extends Builder<Network1Parameters> {
  private TaxonNameSoundEx soundex;

  public Network1Builder() {
    this.soundex = new TaxonNameSoundEx();
  }

  @Override
  public void infer(Classifier<?> classifier) throws InferenceException, StoreException {
    for (String v: classifier.getAll(Network1Observables.v1)) {
      String d = this.soundex.treatWord(v, "species");
      classifier.add(Network1Observables.v2, d);
    }
  }

    @Override
    public void expand(Classifier<?> classifier, Deque<Classifier<?>> parents) throws InferenceException, StoreException {
  }

  @Override
  public Network1Parameters createParameters() {
      return new Network1Parameters();
  }

  @Override
  public void calculate(Network1Parameters parameters, ParameterAnalyser analyser, Classifier<?> classifier) throws InferenceException, StoreException {
    parameters.prior_t$v1 = analyser.computePrior(analyser.getObservation(true, Network1Observables.v1, classifier));
    parameters.inf_t_t$v2 = analyser.computeConditional(analyser.getObservation(true, Network1Observables.v2, classifier) , analyser.getObservation(true, Network1Observables.v1, classifier));
    parameters.inf_t_f$v2 = analyser.computeConditional(analyser.getObservation(true, Network1Observables.v2, classifier) , analyser.getObservation(false, Network1Observables.v1, classifier));
    parameters.inf_t_tt$v3 = analyser.computeConditional(analyser.getObservation(true, Network1Observables.v3, classifier) , analyser.getObservation(true, Network1Observables.v1, classifier), analyser.getObservation(true, Network1Observables.v2, classifier));
    parameters.inf_t_tf$v3 = analyser.computeConditional(analyser.getObservation(true, Network1Observables.v3, classifier) , analyser.getObservation(true, Network1Observables.v1, classifier), analyser.getObservation(false, Network1Observables.v2, classifier));
    parameters.inf_t_ft$v3 = analyser.computeConditional(analyser.getObservation(true, Network1Observables.v3, classifier) , analyser.getObservation(false, Network1Observables.v1, classifier), analyser.getObservation(true, Network1Observables.v2, classifier));
    parameters.inf_t_ff$v3 = analyser.computeConditional(analyser.getObservation(true, Network1Observables.v3, classifier) , analyser.getObservation(false, Network1Observables.v1, classifier), analyser.getObservation(false, Network1Observables.v2, classifier));
  }
}
